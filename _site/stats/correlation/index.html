<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Correlation – Welcome</title>
    <meta name="description" content="Correlation">
    <meta name="keywords" content="">
    <link rel="canonical" href="http://localhost:4000/stats/correlation/">
        <!-- Twitter Cards -->
    <meta name="twitter:title" content="Correlation">
    <meta name="twitter:description" content="Correlation">
    <meta name="twitter:site" content="@username">
    <meta name="twitter:creator" content="@username">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:image" content="http://localhost:4000/assets/img/profile.png">
    <!-- Open Graph -->
    <meta property="og:locale" content="en_US">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Correlation">
    <meta property="og:description" content="Correlation">
    <meta property="og:url" content="http://localhost:4000/stats/correlation/">
    <meta property="og:site_name" content="Welcome">
    <meta property="og:image" content="http://localhost:4000/assets/img/profile.png">

    
    
    <!-- Handheld -->
    <meta name="HandheldFriendly" content="True">
    <meta name="MobileOptimized" content="320">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Favicons -->
    <link rel="apple-touch-icon-precomposed" sizes="57x57" href="http://localhost:4000/assets/img/favicon/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="http://localhost:4000/assets/img/favicon/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="http://localhost:4000/assets/img/favicon/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="http://localhost:4000/assets/img/favicon/apple-touch-icon-144x144.png">
<link rel="icon" type="image/png" href="http://localhost:4000/assets/img/favicon/favicon.png">
<link rel="shortcut icon" href="http://localhost:4000/assets/img/favicon/favicon.ico">

    <!-- Feed -->
    <link rel="alternate" type="application/rss+xml" title="Welcome" href="http://localhost:4000/feed.xml">
    <!-- CSS -->
    <link rel="stylesheet" type="text/css" href="http://localhost:4000/assets/css/main.css">
</head>

  <body>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_CHTML"></script>
    <script type="text/x-mathjax-config">
        MathJax.Hub.Config({
        tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        processEscapes: true},
        jax: ["input/TeX","input/MathML","input/AsciiMath","output/CommonHTML"],
        extensions: ["tex2jax.js","mml2jax.js","asciimath2jax.js","MathMenu.js","MathZoom.js","AssistiveMML.js", "[Contrib]/a11y/accessibility-menu.js"],
        TeX: {
        extensions: ["AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"],
        equationNumbers: {
        autoNumber: "AMS"
      }
    }
  });
</script>

    <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script type="text/javascript">
      $(function() {
        i = 0;
        $('.menuAc').css({
          'color': 'rgba(52, 152, 219, 1)'
        });
        $('.menuAc').click(function(){
          $(this).next('.menuMobil').animate({width:'toggle'},350);
          if (i%2==0) {
            $('.footer').css({
              'filter'         : 'blur(5px)'
            });
            $('.yazilar').css({
              'filter'         : 'blur(5px)'
            });
            $('.ust').css({
              'filter'         : 'blur(5px)'
            });
            $('ul.menu').css({
              'animation-duration': '0.1s'
            });
            i++;
          }
          else {
            $('.footer').css({
              'filter'         : 'blur(0px)'
            });
            $('.yazilar').css({
              'filter'         : 'blur(0px)'
            });
            $('.ust').css({
              'filter'         : 'blur(0px)'
            });
            i++;
          }

        });
      });
    </script>
    <div class="menuAc">
      <i class="fa fa-bars" aria-hidden="true"></i>
    </div>
    <div class="menuMobil">
          <nav class="nav-home">
      <ul class="menu">
            
				    
				    <li><a class="link" href="http://localhost:4000/">Home</a></li>
				
				    
				    <li><a class="link" href="http://localhost:4000/machinelearning/">ML</a></li>
				
				    
				    <li><a class="link" href="http://localhost:4000/stats/">Stats</a></li>
				
				    
				    <li><a class="link" href="http://localhost:4000/about/">About</a></li>
				
        </ul>
    </nav>

    </div>
    <div class="ust">
      <div class="ortalaAna">
        <div class="baslikAna">
          Welcome
        </div>

        <div class="pc">
              <nav class="nav">
        <ul class="menuAna">
            
				    
				    <li class="item"><a class="link" href="http://localhost:4000/">Home</a></li>
				
				    
				    <li class="item"><a class="link" href="http://localhost:4000/machinelearning/">ML</a></li>
				
				    
				    <li class="item"><a class="link" href="http://localhost:4000/stats/">Stats</a></li>
				
				    
				    <li class="item"><a class="link" href="http://localhost:4000/about/">About</a></li>
				
        </ul>
    </nav>

        </div>
      </div>
    </div>
    <div class="ortalaAna">
      <div class="yazilar">
        <div class="yazi">
          <div class="ustr">
            <h2>Correlation</h2>
          </div>
          <hr>
          <div class="content">
            <p><strong>Correlation</strong></p>

<p>[Pearson coefficient]{.underline}:</p>

<p>$\rho_{X,Y} = \frac{cov(X,Y)}{\sigma_X \sigma_Y}$</p>

<p><em>np.cov(a,b)</em> gives a <strong>matrix</strong> with covariances and <strong>unbiased</strong>
variances (on the diagonal).</p>

<p>Several computation equivalences are shown below:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>a = pd.Series([5, 2, 6])
b = pd.Series([18, 2, 5])

print(a.corr(b) # biased standard deviation estimators !!
      == np.corrcoef(a,b)[0,1] 
      == (np.cov(a,b)[0,1] / np.sqrt(np.cov(a,b)[0,0]*np.cov(a,b)[1,1]))
      == np.cov(a,b)[0,1] / (np.std(a,ddof=1)*np.std(b,ddof=1)) 
      != np.cov(a,b)[0,1] / (np.std(a)*np.std(b)))

# prints True
</code></pre>
</div>

<p><em>Note</em>: when we compute those statistics numerically, we use
<strong>empirical</strong> values.</p>

<p>Thus, $\mathbb{V}[X] = \mathbb{E}[X-\mathbb{E}[X]]$ is computed as
$var_n(x)=\frac{1}{n}\Sigma(x_i - \overline{x})^2$</p>

<p>[Autocorrelation (1)]{.underline}:</p>

<p>$R_{k} = \frac{\mathbb{E}[(X_i-\mu_X)(X_{i+k}-\mu_X)]}{\sigma_X^2}$</p>

<p>$X_i$ is the dataset without the last $k$ values</p>

<p>$X_{i+k}$ is the dataset without the first $k$ values</p>

<p>$\mu_X$ is the mean on <strong>the whole</strong> dataset $X$</p>

<p>$\sigma_X^2$ is the variance <strong>the whole</strong> dataset $X$</p>

<p>[Autocorrelation (2)]{.underline}:</p>

<p>$R_{k} = \frac{\mathbb{E}[(X_i-\mu_{X_i})(X_{i+k}-\mu_{X_{i+k}})]}{\sigma_{X_i}\sigma_{X_{i+k}}}$</p>

<p>$X_i$ is the dataset without the last $k$ values</p>

<p>$X_{i+k}$ is the dataset without the first $k$ values</p>

<p>$\mu_{X_i}$ is the mean on dataset $X_i$</p>

<p>$\sigma_{X_i}$ is the standard deviation on dataset $X_i$</p>

<p><em>statsmodels.tsa.stattools.acf</em> uses formula (1).</p>

<p><em>np.autocorr</em> uses formula (2).</p>

<p>Below is the summary of equivalences:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>import statsmodels.tsa.stattools as sm

s = pd.Series([5, 2, 6, 18, 2, 5])

a = pd.Series([5, 2, 6])
b = pd.Series([18, 2, 5])

# Formula (1)
print(s.autocorr(3) # unbiased standard deviation estimators !!
      == a.corr(b)
      ==  np.cov(a,b)[0,1]/(np.std(a,ddof=1)*np.std(b,ddof=1)))

# prints True

# Formula (2)
def acf_by_hand(x, lag):
    y1 = np.array(x[:(len(x)-lag)])
    y2 = np.array(x[lag:])
    sum_product = np.sum((y1-np.mean(x))*(y2-np.mean(x)))
    return sum_product / (len(x) * np.var(x))

print(round(acf_by_hand(s,3),6)
        == round(sm.acf(s)[3],6)) # biased covariance and standard deviation estimators !!

# prints True
</code></pre>
</div>

<p>Below a graphical comparision of both formulas:</p>

<div class="highlighter-rouge">
<pre class="highlight"><code>import statsmodels.tsa.stattools as sm

s = pd.Series([5, 2, 6, 18, 2, 5])
a = pd.Series([5, 2, 6])
b = pd.Series([18, 2, 5])

corr_statsmodel =  sm.acf(s)[1:4]
corr_pandas = [s.autocorr(i) for i in range(1,4)]

test_df = pd.DataFrame([corr_statsmodel, corr_pandas]).T
test_df.columns = ['Pandas Autocorr', 'Statsmodels Autocorr']
test_df.index += 1
test_df.plot(kind='bar')
</code></pre>
</div>

<p><img src="/assets/img/corr_comparison.jpg" alt="image" height="20%" width="50%"></p>

<p>[Partial autocorrelation]{.underline}</p>

<p>Based on article <a href="https://towardsdatascience.com/understanding-partial-auto-correlation-fa39271146ac">understanding-partial-auto-correlation
(towardsdatascience)</a></p>

<table>
  <tbody>
    <tr>
      <td>$PR_k = \frac{cov(X_t</td>
      <td>X_{t-1} … X_{t-k+1},X_{t-k}</td>
      <td>X_{t-1} … X_{t-k+1})}{\sigma_{X_t</td>
      <td>X_{t-1} … X_{t-k+1}} \sigma_{X_{t-k}</td>
      <td>X_{t-1} … X_{t-k+1}}}$</td>
    </tr>
  </tbody>
</table>

<p>$X_t | X_{t-1} … X_{t-k+1}$ is the residual of regression
$X_t = \beta_0 + \beta_1 X_{t-1} + … + \beta_k X_{t-k+1}$</p>

<p>$X_{t-k} | X_{t-1} … X_{t-k+1}$ is the residual of regression
$X_{t-k} = \beta_0 + \beta_1 X_{t-1} + … + \beta_k X_{t-k+1}$</p>

<p>Thus, one can write:</p>

<p>$PR_k = \rho_{\epsilon_t,\epsilon_{t-k}}$</p>

<p>We use partial autocorrelation in order to define the order $p$ in which
we can compute an AR(p) model.</p>

<p><img src="/assets/img/PACF.png" alt="image" height="20%" width="50%"></p>

<p>Based on this graph, we can use an AR(2) or even AR(3) ($k=3$ is just
outside the 95% confidence interval.</p>

          </div>
        </div>
        <script src="http://localhost:4000/assets/js/jquery-1.12.2.min.js"></script>
<script src="http://localhost:4000/assets/js/jquery.goup.min.js"></script>
<script type="text/javascript">
$(document).ready(function(){
    $.goup({
        trigger: 500,
        bottomOffset: 10,
        locationOffset: 20,
        containerRadius: 0,
        containerColor: '#fff',
        arrowColor: '#000',
        goupSpeed: 'normal'
    });
});
</script>


      </div>
    </div>
        <div class="footer">
      <div class="ortalaAna">
        <div class="copy">
          Welcome © 2020
        </div>
        <div class="sosyal">
                        <div class="social-links">
                  
                  <a href="http://twitter.com/username" class="author-social" target="_blank"><i class="fa fa-2x fa-twitter-square"></i></a>
                  <a href="http://facebook.com/username" class="author-social" target="_blank"><i class="fa fa-2x fa-facebook-square"></i></a>
                  
                  <a href="http://linkedin.com/in/username" class="author-social" target="_blank"><i class="fa fa-2x fa-linkedin-square"></i></a>
                  
                  <a href="http://instagram.com/username" class="author-social" target="_blank"><i class="fa fa-2x fa-instagram"></i></a>
                  <a href="http://username.tumblr.com" class="author-social" target="_blank"><i class="fa fa-2x fa-tumblr-square"></i></a>
                  <a href="http://github.com/username" class="author-social" target="_blank"><i class="fa fa-2x fa-github"></i></a>
                  
                  <a href="http://lastfm.com/user/username" class="author-social" target="_blank"><i class="fa fa-2x fa-music"></i></a>
                  
                  
                  
                  <a href="http://steamcommunity.com/id/username" class="author-social" target="_blank"><i class="fa fa-2x fa-steam-square"></i></a>
                  <a href="https://youtube.com/user/username" class="author-social" target="_blank"><i class="fa fa-2x fa-youtube-square"></i></a>
                  
                  
                  
                  
            </div>

        </div>
      </div>
    </div>

  </body>
</html>
